{"ast":null,"code":"/**\n * This file contains some function stubs(ie incomplete functions) that\n * you MUST use to begin the work for calculating the grades.\n *\n * You may need more functions than are currently here...we highly encourage you to define more.\n *\n * Anything that has a type of \"undefined\" you will need to replace with something.\n */\n\nimport { GET_DEFAULT_HEADERS, BASE_API_URL, MY_BU_ID } from \"../globals\";\n\n// const [classList, setClassList] = useState<IClassAssignments[]>([]);\n/**\n * This function might help you write the function below.\n * It retrieves the final grade for a single student based on the passed params.\n * \n * If you are reading here and you haven't read the top of the file...go back.\n */\nexport function calculateStudentFinalGrade(student, classAssignments) {\n  let weightDist = new Map();\n  classAssignments.forEach(function (assignment) {\n    weightDist.set(assignment.assignmentId, assignment.weight);\n  });\n  let finalGrade = 0;\n  Object.keys(student.grades[0]).forEach(function (assignment) {\n    finalGrade += weightDist.get(assignment) / 100 * parseInt(student.grades[0][assignment]);\n  });\n  return Math.round(finalGrade * 100) / 100;\n}\nasync function grabAssignmentWeight(classID) {\n  const res = await fetch(`${BASE_API_URL}/class/listAssignments/${classID}?buid=${MY_BU_ID}`, {\n    method: \"GET\",\n    headers: GET_DEFAULT_HEADERS()\n  });\n  const json = await res.json();\n  return json;\n}\nasync function grabStudentsID(classID) {\n  const res = await fetch(`${BASE_API_URL}/class/listStudents/${classID}?buid=${MY_BU_ID}`, {\n    method: \"GET\",\n    headers: GET_DEFAULT_HEADERS()\n  });\n  const json = await res.json();\n  return json;\n}\nasync function grabStudentsData(studentIDArr) {\n  const promises = studentIDArr.map(async function (sid) {\n    const res = await fetch(`${BASE_API_URL}/student/GetById/${sid}?buid=${MY_BU_ID}`, {\n      method: \"GET\",\n      headers: GET_DEFAULT_HEADERS()\n    });\n    const json = await res.json();\n    return json[0];\n  });\n  const arr = await Promise.all(promises);\n  return arr;\n}\nasync function grabStudentsGrade(classID, studentIDArr) {\n  const promises = studentIDArr.map(async function (sid) {\n    const res = await fetch(`${BASE_API_URL}/student/listGrades/${sid.universityId}/${classID}?buid=${MY_BU_ID}`, {\n      method: \"GET\",\n      headers: GET_DEFAULT_HEADERS()\n    });\n    const json = await res.json();\n    return json;\n  });\n  const arr = await Promise.all(promises);\n  return arr;\n}\nasync function grabCourseInfo(classID) {\n  const res = await fetch(`${BASE_API_URL}/class/GetById/${classID}?buid=${MY_BU_ID}`, {\n    method: \"GET\",\n    headers: GET_DEFAULT_HEADERS()\n  });\n  const json = await res.json();\n  return json;\n}\n\n/**\n * You need to write this function! You might want to write more functions to make the code easier to read as well.\n * \n *  If you are reading here and you haven't read the top of the file...go back.\n * \n * @param classID The ID of the class for which we want to calculate the final grades\n * @returns Some data structure that has a list of each student and their final grade.\n */\nexport async function calcAllFinalGrade(classID) {\n  if (classID === \"\") {\n    return {\n      studentId: \"-1\",\n      name: \"-1\",\n      classId: \"-1\",\n      title: \"-1\",\n      semester: \"-1\",\n      finalGrade: -1\n    };\n  }\n  let assignmentWeightArr = await grabAssignmentWeight(classID);\n  let studentIDArr = await grabStudentsID(classID);\n  let studentDataArr = await grabStudentsData(studentIDArr);\n  let gradesPerStudentArr = await grabStudentsGrade(classID, studentDataArr);\n  let courseInfo = await grabCourseInfo(classID);\n  console.log(assignmentWeightArr);\n  console.log(studentIDArr);\n  console.log(studentDataArr);\n  console.log(gradesPerStudentArr);\n  console.log(courseInfo);\n  let finalGradesArr = [];\n  gradesPerStudentArr.forEach(function (student) {\n    finalGradesArr.push({\n      studentId: student.studentId,\n      name: student.name,\n      classId: classID,\n      title: courseInfo.title,\n      semester: \"fall2022\",\n      finalGrade: calculateStudentFinalGrade(student, assignmentWeightArr)\n    });\n  });\n  return finalGradesArr;\n}","map":{"version":3,"names":["GET_DEFAULT_HEADERS","BASE_API_URL","MY_BU_ID","calculateStudentFinalGrade","student","classAssignments","weightDist","Map","forEach","assignment","set","assignmentId","weight","finalGrade","Object","keys","grades","get","parseInt","Math","round","grabAssignmentWeight","classID","res","fetch","method","headers","json","grabStudentsID","grabStudentsData","studentIDArr","promises","map","sid","arr","Promise","all","grabStudentsGrade","universityId","grabCourseInfo","calcAllFinalGrade","studentId","name","classId","title","semester","assignmentWeightArr","studentDataArr","gradesPerStudentArr","courseInfo","console","log","finalGradesArr","push"],"sources":["/Users/simonkye/Documents/Spark/spark-fall-2023-software-engineering-assessment-KKeySimon/src/utils/calculate_grade.ts"],"sourcesContent":["/**\n * This file contains some function stubs(ie incomplete functions) that\n * you MUST use to begin the work for calculating the grades.\n *\n * You may need more functions than are currently here...we highly encourage you to define more.\n *\n * Anything that has a type of \"undefined\" you will need to replace with something.\n */\nimport { IUniversityClass, IClassAssignments, IUniversityStudent, IStudentGrades, ICalculateGrades } from \"../types/api_types\";\nimport { GET_DEFAULT_HEADERS, BASE_API_URL, MY_BU_ID } from \"../globals\";\n\n// const [classList, setClassList] = useState<IClassAssignments[]>([]);\n/**\n * This function might help you write the function below.\n * It retrieves the final grade for a single student based on the passed params.\n * \n * If you are reading here and you haven't read the top of the file...go back.\n */\nexport function calculateStudentFinalGrade(\n  student: IStudentGrades,\n  classAssignments: IClassAssignments[]\n) : number {\n  \n  let weightDist = new Map();\n  classAssignments.forEach(function (assignment) {\n    weightDist.set(assignment.assignmentId, assignment.weight);\n  });\n  let finalGrade = 0\n  Object.keys(student.grades[0]).forEach(function (assignment) {\n    finalGrade += weightDist.get(assignment) / 100 * parseInt(student.grades[0][assignment])\n  });\n  return Math.round(finalGrade * 100) / 100\n}\n\nasync function grabAssignmentWeight(classID: string): Promise<IClassAssignments[]> {\n  const res = await fetch(`${BASE_API_URL}/class/listAssignments/${classID}?buid=${MY_BU_ID}`, {\n    method: \"GET\",\n    headers: GET_DEFAULT_HEADERS(),\n  });\n  const json = await res.json();\n  return json;\n}\n\nasync function grabStudentsID(classID: string): Promise<string[]> {\n  const res = await fetch(`${BASE_API_URL}/class/listStudents/${classID}?buid=${MY_BU_ID}`, {\n    method: \"GET\",\n    headers: GET_DEFAULT_HEADERS(),\n  });\n  const json = await res.json();\n  return json;\n}\n\nasync function grabStudentsData(studentIDArr: string[]): Promise<IUniversityStudent[]> {\n  const promises = studentIDArr.map(async function (sid) {\n    const res = await fetch(`${BASE_API_URL}/student/GetById/${sid}?buid=${MY_BU_ID}`, {\n      method: \"GET\",\n      headers: GET_DEFAULT_HEADERS(),\n    });\n    const json = await res.json();\n    return json[0]\n  })\n  const arr = await Promise.all(promises)\n  return arr;\n}\n\nasync function grabStudentsGrade(classID : string, studentIDArr: IUniversityStudent[]): Promise<IStudentGrades[]> {\n  const promises = studentIDArr.map(async function (sid) {\n    const res = await fetch(`${BASE_API_URL}/student/listGrades/${sid.universityId}/${classID}?buid=${MY_BU_ID}`, {\n      method: \"GET\",\n      headers: GET_DEFAULT_HEADERS(),\n    });\n    const json = await res.json();\n    return json\n  })\n  const arr = await Promise.all(promises)\n  return arr;\n}\n\nasync function grabCourseInfo(classID : string): Promise<IUniversityClass> {\n  const res = await fetch(`${BASE_API_URL}/class/GetById/${classID}?buid=${MY_BU_ID}`, {\n    method: \"GET\",\n    headers: GET_DEFAULT_HEADERS(),\n  });\n  const json = await res.json();\n  return json\n}\n\n/**\n * You need to write this function! You might want to write more functions to make the code easier to read as well.\n * \n *  If you are reading here and you haven't read the top of the file...go back.\n * \n * @param classID The ID of the class for which we want to calculate the final grades\n * @returns Some data structure that has a list of each student and their final grade.\n */\nexport async function calcAllFinalGrade(classID: string): Promise<ICalculateGrades> {\n  if (classID === \"\") {\n    return {\n      studentId: \"-1\",\n      name: \"-1\",\n      classId: \"-1\",\n      title: \"-1\",\n      semester: \"-1\",\n      finalGrade: -1\n    }\n  }\n  let assignmentWeightArr = await grabAssignmentWeight(classID);\n  let studentIDArr = await grabStudentsID(classID);\n  let studentDataArr = await grabStudentsData(studentIDArr);\n  let gradesPerStudentArr = await grabStudentsGrade(classID, studentDataArr);\n  let courseInfo = await grabCourseInfo(classID)\n  \n  console.log(assignmentWeightArr)\n  console.log(studentIDArr)\n  console.log(studentDataArr)\n  console.log(gradesPerStudentArr)\n  console.log(courseInfo)\n  let finalGradesArr : ICalculateGrades[] = []\n  gradesPerStudentArr.forEach(function (student) {\n    finalGradesArr.push({\n      studentId: student.studentId,\n      name: student.name,\n      classId: classID,\n      title: courseInfo.title,\n      semester: \"fall2022\",\n      finalGrade: calculateStudentFinalGrade(student, assignmentWeightArr)\n    })\n  })\n  \n  return finalGradesArr;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}